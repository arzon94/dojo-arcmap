//>>built
require({cache:{"url:esri/views/3d/webgl-engine/materials/internal/offscreen.xml":'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e\n\n\x3csnippets\x3e\n\n\x3csnippet name\x3d"vsOffscreenRenderer"\x3e\x3c![CDATA[\n  $vsprecisionf\n\n  attribute vec2 $position;\n  attribute vec2 $uv0;\n  varying vec2 vtc;\n\n  void main(void) {\n    gl_Position \x3d vec4(position.xy, 0.0, 1.0);\n    vtc \x3d $uv0.xy * 0.5 + 0.5;\n  }\n]]\x3e\x3c/snippet\x3e\n\n\x3csnippet name\x3d"fsOffscreenRenderer"\x3e\x3c![CDATA[\n  $fsprecisionf\n\n  uniform sampler2D tex;\n  varying vec2 vtc;\n\n  void main() {\n    vec4 texColor \x3d texture2D(tex, vtc);\n    gl_FragColor \x3d texColor;\n  }\n\n]]\x3e\x3c/snippet\x3e\n\n\x3c/snippets\x3e\n'}});
define("require exports ./Util dojo/text!../materials/internal/offscreen.xml ../../../webgl/FramebufferObject ../../../webgl/Texture ../../../webgl/VertexArrayObject ../../../webgl/BufferObject ../../../webgl/Program ../../../webgl/Util ../../../webgl/enums ./DefaultVertexBufferLayouts ./DefaultVertexAttributeLocations".split(" "),function(u,v,d,g,h,k,l,m,n,p,w,q,f){var r={target:3553,pixelFormat:6408,dataType:5121,samplingMode:9729,wrapMode:33071,width:0,height:0},t={target:3553,pixelFormat:6408,
dataType:32819,samplingMode:9729,wrapMode:33071,width:0,height:0};return function(){function a(b,a){this._hudVisibilityTexture=null;this._enabled=!1;this.height=this.width=0;this._programRep=b;this._rctx=a;this.height=this.width=null}return a.prototype.enable=function(){if(!this.getEnableState()){var b=this._rctx;this._enabled=!0;this.framebuffer=h.createWithAttachments(b,r,{colorTarget:0,depthStencilTarget:b.extensions.depthTexture?4:3});this.quadVAO=this.createQuadVAO(b)}},a.prototype.disable=function(){this.getEnableState()&&
(this._enabled=!1,this.framebuffer.dispose(),this.quadVAO.dispose(!0),this.framebuffer=null,this.quadVAO=null,this._depthStencilTextureCached=null)},a.prototype.createQuadVAO=function(b){var a=new Float32Array([-1,-1,-1,-1,1,-1,1,-1,-1,1,-1,1,1,1,1,1]);return new l(b,f.Default3D,{geometry:q.Pos2Tex},{geometry:m.createVertex(b,35044,a)})},a.prototype.setEnableState=function(b){b?this.enable():this.disable()},a.prototype.getEnableState=function(){return this._enabled},a.prototype.getColorTexture=function(){return this.framebuffer.colorTexture},
a.prototype.getDepthTexture=function(){return a.supportsDepthTexture(this._rctx.extensions)?this.framebuffer.depthStencilTexture||this._depthStencilTextureCached:null},a.prototype.getHUDVisibilityTexture=function(){return this._hudVisibilityTexture},a.supportsDepthTexture=function(b){return!!b.depthTexture},a.prototype.initializeFrame=function(b){d.assert(this.getEnableState());var a=this._rctx,c=a.gl;b=b.fullViewport;this.width=b[2];this.height=b[3];this.framebuffer.resize(this.width,this.height);
a.bindFramebuffer(this.framebuffer);a.setStencilWriteMask(255);a.setClearStencil(0);a.setClearColor(0,0,0,1);a.clear(c.COLOR_BUFFER_BIT|c.DEPTH_BUFFER_BIT|c.STENCIL_BUFFER_BIT)},a.prototype.renderHUDVisibility=function(b){var a=this._rctx,c=a.gl;this._hudVisibilityTexture||(this._hudVisibilityTexture=new k(a,t));this._hudVisibilityTexture.resize(this.width,this.height);var e=this.framebuffer.detachColorTexture();this.framebuffer.attachColorTexture(this._hudVisibilityTexture);a.bindFramebuffer(this.framebuffer);
a.setClearColor(0,0,0,1);a.clear(c.COLOR_BUFFER_BIT);b();c.flush();this.framebuffer.detachColorTexture();this.framebuffer.attachColorTexture(e)},a.prototype.bindFramebuffer=function(){this._rctx.bindFramebuffer(this.framebuffer)},a.prototype.getFramebuffer=function(){return this.framebuffer},a.prototype.detachDepthTextureFromBuffer=function(){this._depthStencilTextureCached=this.framebuffer.depthStencilTexture;this.framebuffer.detachDepthStencilTexture()},a.prototype.restoreDepthTextureToBuffer=function(){this.framebuffer.attachDepthStencilTexture(this._depthStencilTextureCached);
this._depthStencilTextureCached=null},a.prototype.drawQuad=function(a){d.assert(this.getEnableState());a=this._rctx;var b=a.gl,c=this._programRep.get("offscreenProgram");a.bindFramebuffer();a.setDepthTestEnabled(!1);a.clear(b.COLOR_BUFFER_BIT);a.bindProgram(c);c.setUniform1i("tex",1);a.bindTexture(this.framebuffer.colorTexture,1);a.bindVAO(this.quadVAO);a.drawArrays(5,0,p.vertexCount(this.quadVAO,"geometry"));a.setDepthTestEnabled(!0)},a.loadShaders=function(a,d,c,e){a._parse(g);a=new n(e,a.vsOffscreenRenderer,
a.fsOffscreenRenderer,f.Default3D);c.add("offscreenProgram",a)},a}()});