//>>built
define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/accessorSupport/decorators ../core/Error ../core/lang ../geometry/Extent ../core/JSONSupport ../core/Loadable ./Portal ./PortalRating ../core/promiseUtils".split(" "),function(l,d,m,e,c,n,p,h,q,r,k,f,t){d=g=function(d){function c(b){b=d.call(this)||this;return b.access=null,b.accessInformation=null,b.appProxies=null,b.avgRating=null,b.created=null,b.culture=null,b.description=null,b.extent=null,
b.id=null,b.itemControl=null,b.licenseInfo=null,b.modified=null,b.name=null,b.numComments=null,b.numRatings=null,b.numViews=null,b.owner=null,b.portal=null,b.size=null,b.snippet=null,b.tags=null,b.title=null,b.type=null,b.typeKeywords=null,b.url=null,b}return m(c,d),Object.defineProperty(c.prototype,"displayName",{get:function(){var b=this.type,a=this.typeKeywords||[],c=b;return"Feature Service"===b||"Feature Collection"===b?c=-1<a.indexOf("Table")?"Table":-1<a.indexOf("Route Layer")?"Route Layer":
-1<a.indexOf("Markup")?"Markup":"Feature Layer":"Image Service"===b?c=-1<a.indexOf("Elevation 3D Layer")?"Elevation Layer":"Imagery Layer":"Scene Service"===b?c="Scene Layer":"Scene Package"===b?c="Scene Layer Package":"Stream Service"===b?c="Feature Layer":"Geoprocessing Service"===b&&this.portal&&this.portal.isPortal?c=-1<a.indexOf("Web Tool")?"Tool":"Geoprocessing Service":"Geocoding Service"===b?c="Locator":"Microsoft Powerpoint"===b?c="Microsoft PowerPoint":"GeoJson"===b?c="GeoJSON":"Globe Service"===
b?c="Globe Layer":"Vector Tile Service"===b?c="Tile Layer":"Map Service"===b?c=-1===a.indexOf("Spatiotemporal")&&(-1<a.indexOf("Hosted Service")||-1<a.indexOf("Tiled"))?"Tile Layer":"Map Image Layer":b&&-1<b.toLowerCase().indexOf("add in")?c=b.replace(/(add in)/gi,"Add-In"):"datastore catalog service"===b&&(c="Big Data File Share"),c},enumerable:!0,configurable:!0}),c.prototype.readExtent=function(b){return b&&b.length?new h(b[0][0],b[0][1],b[1][0],b[1][1]):null},Object.defineProperty(c.prototype,
"iconUrl",{get:function(){var b,a=this.type&&this.type.toLowerCase()||"",c=this.typeKeywords||[],d=!1,e=!1,f=!1,g=!1;return 0<a.indexOf("service")||"feature collection"===a||"kml"===a||"wms"===a||"wmts"===a||"wfs"===a?(d=-1<c.indexOf("Hosted Service"),"feature service"===a||"feature collection"===a||"kml"===a||"wfs"===a?(e=-1<c.indexOf("Table"),f=-1<c.indexOf("Route Layer"),g=-1<c.indexOf("Markup"),b=e?"table":f?"routelayer":g?"markup":d?"featureshosted":"features"):b="map service"===a||"wms"===a||
"wmts"===a?d||-1<c.indexOf("Tiled")||"wmts"===a?"maptiles":"mapimages":"scene service"===a?-1<c.indexOf("Line")?"sceneweblayerline":-1<c.indexOf("3DObject")?"sceneweblayermultipatch":-1<c.indexOf("Point")?"sceneweblayerpoint":-1<c.indexOf("IntegratedMesh")?"sceneweblayermesh":-1<c.indexOf("PointCloud")?"sceneweblayerpointcloud":-1<c.indexOf("Polygon")?"sceneweblayerpolygon":"sceneweblayer":"image service"===a?-1<c.indexOf("Elevation 3D Layer")?"elevationlayer":"imagery":"stream service"===a?"streamlayer":
"vector tile service"===a?"vectortile":"datastore catalog service"===a?"datastorecollection":"geocoding service"===a?"geocodeservice":"layers"):b="web map"===a||"cityengine web scene"===a?"maps":"web scene"===a?-1<c.indexOf("ViewingMode-Local")?"webscenelocal":"websceneglobal":"web mapping application"===a||"mobile application"===a||"application"===a||"operation view"===a||"desktop application"===a?"apps":"map document"===a||"map package"===a||"published map"===a||"scene document"===a||"globe document"===
a||"basemap package"===a||"mobile basemap package"===a||"mobile map package"===a||"project package"===a||"project template"===a||"pro map"===a||"layout"===a||"layer"===a&&-1<c.indexOf("ArcGIS Pro")||"explorer map"===a&&c.indexOf("Explorer Document")?"mapsgray":"service definition"===a||"csv"===a||"shapefile"===a||"cad drawing"===a||"geojson"===a||"360 vr experience"===a?"datafiles":"explorer add in"===a||"desktop add in"===a||"windows viewer add in"===a||"windows viewer configuration"===a?"appsgray":
"arcgis pro add in"===a||"arcgis pro configuration"===a?"addindesktop":"rule package"===a||"file geodatabase"===a||"csv collection"===a||"kml collection"===a||"windows mobile package"===a||"map template"===a||"desktop application template"===a||"arcpad package"===a||"code sample"===a||"form"===a||"document link"===a||"vector tile package"===a||"operations dashboard add in"===a||"rules package"===a||"image"===a||"workflow manager package"===a||"desktop style"===a||"explorer map"===a&&-1<c.indexOf("Explorer Mapping Application")||
-1<c.indexOf("Document")?"datafilesgray":"network analysis service"===a||"geoprocessing service"===a||"geodata service"===a||"geometry service"===a||"geoprocessing package"===a||"locator package"===a||"geoprocessing sample"===a||"workflow manager service"===a||"raster function template"===a?"toolsgray":"layer"===a||"layer package"===a||"explorer layer"===a?"layersgray":"scene package"===a?"scenepackage":"tile package"===a?"tilepackage":"task file"===a?"taskfile":"report template"===a?"report-template":
"statistical data collection"===a?"statisticaldatacollection":"insights workbook"===a?"workbook":"insights model"===a?"insightsmodel":"insights page"===a?"insightspage":"hub initiative"===a?"hubinitiative":"hubpage"===a?"hubpage":"hub site application"===a?"hubsite":"relational database connection"===a?"relationaldatabaseconnection":"big data file share"===a?"datastorecollection":"image collection"===a?"imagecollection":"style"===a?"style":"dashboard"===a?"dashboard":"maps",b?l.toUrl("../images/portal/"+
b+"16.png"):null},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"isLayer",{get:function(){return-1<"Map Service;Feature Service;Feature Collection;Scene Service;Image Service;Stream Service;Vector Tile Service;WMTS;WMS".split(";").indexOf(this.type)},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"itemUrl",{get:function(){var b=this.get("portal.restUrl");return b?b+"/content/items/"+this.id:null},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,
"thumbnailUrl",{get:function(){var b=this.itemUrl,a=this.thumbnail;return b&&a?this.portal._normalizeUrl(b+"/info/"+a+"?f\x3djson"):null},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"userItemUrl",{get:function(){var b=this.get("portal.restUrl");if(!b)return null;var a=this.owner||this.get("portal.user.username");return a?b+"/content/users/"+(this.ownerFolder?a+"/"+this.ownerFolder:a)+"/items/"+this.id:null},enumerable:!0,configurable:!0}),c.prototype.load=function(){var b=this;
this.portal||(this.portal=k.getDefault());var a=this.portal.load().then(function(){return b.resourceInfo?b.resourceInfo:b.id&&b.itemUrl?b.portal._request(b.itemUrl):{}}).then(function(a){b.resourceInfo=a;b.read(a)});return this.addResolvingPromise(a),this},c.prototype.addRating=function(b){var a={method:"post",query:{}};return b instanceof f&&(b=b.rating),isNaN(b)||"number"!=typeof b||(a.query.rating=b),this.portal._request(this.itemUrl+"/addRating",a).then(function(){return new f({rating:b,created:new Date})})},
c.prototype.deleteRating=function(){return this.portal._request(this.itemUrl+"/deleteRating",{method:"post"}).then(function(){})},c.prototype.fetchData=function(b){return void 0===b&&(b="json"),this.portal._request(this.itemUrl+"/data",{responseType:b})},c.prototype.fetchRating=function(){return this.portal._request(this.itemUrl+"/rating").then(function(b){return null!=b.rating?(b.created=new Date(b.created),new f(b)):null})},c.prototype.fetchRelatedItems=function(b){return this.portal._requestToTypedArray(this.itemUrl+
"/relatedItems",{query:b},"PortalItem")},c.prototype.getThumbnailUrl=function(b){var a=this.thumbnailUrl;return a&&b&&(a+="\x26w\x3d"+b),a},c.prototype.update=function(b){var a=this;return this.id?this.load().then(function(){return a.portal._signIn()}).then(function(){var c=b&&b.data,d={method:"post"};d.query=a._getPostQuery();for(var e in d.query)null===d.query[e]&&(d.query[e]="");return d.query.clearEmptyFields=!0,null!=c&&("string"==typeof c?d.query.text=c:"object"==typeof c&&(d.query.text=JSON.stringify(c))),
a.portal._request(a.userItemUrl+"/update",d).then(function(){return a._reload()})}):t.reject(new n("portal:item-does-not-exist","The item does not exist yet and cannot be updated"))},c.prototype.toJSON=function(){var b=this.extent,b={created:this.created&&this.created.getTime(),description:this.description,extent:b&&[[b.xmin,b.ymin],[b.xmax,b.ymax]],id:this.id,modified:this.modified&&this.modified.getTime(),name:this.name,owner:this.owner,ownerFolder:this.ownerFolder,snippet:this.snippet,tags:this.tags,
thumbnail:this.thumbnail,title:this.title,type:this.type,typeKeywords:this.typeKeywords,url:this.url};return p.fixJson(b)},c.fromJSON=function(b){if(!b)return null;if(b.declaredClass)throw Error("JSON object is already hydrated");return new g({resourceInfo:b})},c.prototype._reload=function(){var b=this;return this.portal._request(this.itemUrl,{query:{_ts:(new Date).getTime()}}).then(function(a){return b.resourceInfo=a,b.read(a),b})},c.prototype._getPostQuery=function(){var b=this.toJSON(),a;for(a in b)"tags"===
a&&null!==b[a]&&(b[a]=b[a].join(", ")),"typeKeywords"===a&&null!==b[a]&&(b[a]=b[a].join(", "));return b},c}(c.declared(q,r));e([c.property()],d.prototype,"access",void 0);e([c.property()],d.prototype,"accessInformation",void 0);e([c.property()],d.prototype,"appProxies",void 0);e([c.property()],d.prototype,"avgRating",void 0);e([c.property({type:Date})],d.prototype,"created",void 0);e([c.property()],d.prototype,"culture",void 0);e([c.property()],d.prototype,"description",void 0);e([c.property({dependsOn:["type",
"typeKeywords"],readOnly:!0})],d.prototype,"displayName",null);e([c.property({type:h})],d.prototype,"extent",void 0);e([c.reader("extent")],d.prototype,"readExtent",null);e([c.property({dependsOn:["type","typeKeywords"],readOnly:!0})],d.prototype,"iconUrl",null);e([c.property()],d.prototype,"id",void 0);e([c.property({dependsOn:["type"],readOnly:!0})],d.prototype,"isLayer",null);e([c.property()],d.prototype,"itemControl",void 0);e([c.property({dependsOn:["portal.restUrl","id"],readOnly:!0})],d.prototype,
"itemUrl",null);e([c.property()],d.prototype,"licenseInfo",void 0);e([c.property({type:Date})],d.prototype,"modified",void 0);e([c.property()],d.prototype,"name",void 0);e([c.property()],d.prototype,"numComments",void 0);e([c.property()],d.prototype,"numRatings",void 0);e([c.property()],d.prototype,"numViews",void 0);e([c.property()],d.prototype,"owner",void 0);e([c.property()],d.prototype,"ownerFolder",void 0);e([c.property({type:k})],d.prototype,"portal",void 0);e([c.property()],d.prototype,"resourceInfo",
void 0);e([c.property()],d.prototype,"size",void 0);e([c.property()],d.prototype,"snippet",void 0);e([c.property()],d.prototype,"tags",void 0);e([c.property()],d.prototype,"thumbnail",void 0);e([c.property({dependsOn:["itemUrl","thumbnail","portal.credential.token"],readOnly:!0})],d.prototype,"thumbnailUrl",null);e([c.property()],d.prototype,"title",void 0);e([c.property()],d.prototype,"type",void 0);e([c.property()],d.prototype,"typeKeywords",void 0);e([c.property()],d.prototype,"url",void 0);e([c.property({dependsOn:["portal.restUrl",
"portal.user.username","owner","ownerFolder","id"],readOnly:!0})],d.prototype,"userItemUrl",null);d=g=e([c.subclass("esri.portal.PortalItem")],d);var g;return d});